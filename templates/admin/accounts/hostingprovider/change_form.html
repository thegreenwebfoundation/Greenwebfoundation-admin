{% extends "admin/change_form.html" %}

{% block extrahead %}
  <script src="{% url 'admin:jsi18n' %}"></script>
  {% comment %} {{ block.super }} {% endcomment %}

  {% comment %}

This introduces hard coding of the media elements in as a last ditch attempt to get past the infuriating "no tags when debug off" issue, on the hosting provider page.
below is the same output as is generated by outputing:

{% block.super %}

... but we are serving unminified versions of all the files.

  {% endcomment %}

  <link href="/static/taggit_labels/css/taggit_labels.css" type="text/css" media="all" rel="stylesheet">
  <link href="/static/admin/css/vendor/select2/select2.css" type="text/css" media="screen" rel="stylesheet">
  <link href="/static/admin/css/autocomplete.css" type="text/css" media="screen" rel="stylesheet">
  <link href="/static/autocomplete_light/select2.css" type="text/css" media="screen" rel="stylesheet">
  <script src="/static/admin/js/vendor/jquery/jquery.js"></script>
  <script src="/static/admin/js/vendor/select2/select2.full.js"></script>
  <script src="/static/admin/js/calendar.js"></script>
  <script src="/static/admin/js/jquery.init.js"></script>
  <script src="/static/autocomplete_light/autocomplete_light.js"></script>
  <script src="/static/admin/js/admin/DateTimeShortcuts.js"></script>
  <script src="/static/admin/js/core.js"></script>
  <script src="/static/autocomplete_light/select2.js"></script>
  <script src="/static/admin/js/inlines.js"></script>
  <script src="/static/greencheck/js/email.js"></script>
  <script src="/static/admin/js/admin/RelatedObjectLookups.js"></script>
  <script src="/static/taggit_labels/js/taggit_labels.js"></script>
  <script src="/static/autocomplete_light/i18n/en.js"></script>
  <script src="/static/admin/js/actions.js"></script>
  <script src="/static/admin/js/urlify.js"></script>
  <script src="/static/admin/js/prepopulate.js"></script>
  <script src="/static/admin/js/vendor/xregexp/xregexp.js"></script>

{% endblock %}


{% block field_sets %}
  {% for fieldset in adminform %}
    {% if fieldset.name == "Hostingprovider info" %}
      {% include "admin/accounts/hostingprovider/hosting_provider_fieldset.html" %}
    {% else %}
      {% include "admin/includes/fieldset.html" %}
    {% endif %}
  {% endfor %}
{% endblock %}



{% block inline_field_sets %}

  {% comment %}
  This is not very nice, but hacking django admin is never nice

  we normally list the following inlines first, as described in
  `HostingAdmin.inlines`:

  GreencheckIpApproveInline,
  GreencheckIpInline,

  but when we have too many IPs to show because they
  have been bulk imported, we need a way to keep the page editable, whilst
  allowing for changes to specific IP ranges.

  The two code blocks below render similar markup to the inlines, but without
  any management forms, so there is less risk of accidentally making changes to
  IP ranges accidentally when updating other parts of the provider on the
  change page:
  {% endcomment %}


  {% if ip_approval_count > 1000 %}
    <div class="inline-group">
      <fieldset class="module">
        <h2>IP approvals</h2>

        <p>
          There are {{ ip_approval_count }} ip approval requests associated with this provider, which is too many to show on this page. Follow this
          <a href="{{ bulk_edit_ip_approval_link }}">
            this link to the bulk editing interface, with this provider pre-selected.
          </a>
        </p>
      </fieldset>
    </div>
  {% endif %}

  {% if ip_range_count > 1000 %}
    <div class="inline-group">
      <fieldset class="module">
        <h2>IP Ranges:</h2>
        <p>
          There are {{ ip_range_count }} ip ranges associated with this provider, which is too many to show on this page. Follow this
          <a href="{{ bulk_edit_ip_range_link }}">
            this link to the bulk editing interface, with this provider pre-selected.
          </a>
        </p>
      </fieldset>
    </div>
  {% endif %}

  {% for inline_admin_formset in inline_admin_formsets %}
    {% include inline_admin_formset.opts.template %}
  {% endfor %}

{% endblock %}

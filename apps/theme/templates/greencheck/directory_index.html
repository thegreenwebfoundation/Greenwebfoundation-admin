{% extends 'base_directory.html' %}
{% load humanize %}
{% load static %}
{% load widget_tweaks %}
{% load tailwind_filters %}
{% block content %}
    <div class="full-width bg-neutral-900 relative -top-6 md:-top-8">
        <section class="container mx-auto text-white pt-12 pb-8 px-2 sm:px-4 lg:pb-12">
            
            <h1 class="text-5xl md:text-disp-sm md:mt-6 pb-4">I'm looking for</h1>
            <form method="get"
                class="form__directory mt-4 grid grid-cols-1 lg:grid-cols-4 grid-rows-3 lg:grid-rows-1 gap-6">
                {{ filter.form.as_p }}
                <input type="submit" class="btn p-4 mt-4 mb-4 lg:col-span-4 lg:justify-self-end lg:w-1/4" value="Find" />
            </form>

			<details class="prose mt-6 md:mt-8 lg:mt-0">
				<summary class="uppercase text-green">What is this directory for? 
					<span class="utility-icon info-circle">&#x2139;</span>
				</summary>
				<p class="text-white mt-2">
					The Green Web Directory is a searchable list which enables people to 
					quickly find verified green hosting companies. These are organisations that offer 
					<a class="text-white" href="https://www.thegreenwebfoundation.org/directory/services-offered/" target="_blank" rel="noopener noreferrer">
						hosting services</a>
					and can demonstrate they are taking steps to avoid, reduce or offset 
					the greenhouse gas emissions caused by using electricity to provide their 
					services. They share evidence with us, Green Web Foundation, 
					to show they're doing this on a yearly basis, or better. Verification is free. 
					<a class="text-white" href="https://www.thegreenwebfoundation.org/green-web-datasets/get-verified/" target="_blank" rel="noopener noreferrer">
						How to get verified</a>.
				</p>
			</details>
        </section>
    </div>

    <section class="main-content container mx-auto mb-8 mt-4 lg:mt-6">

        {% regroup ordered_results by country.name as country_list %}

			<p class="mb-8 md:mb-10 lg:mb-12">Showing {{ ordered_results|length }} verified green hosting providers in {{ country_list|length }} countries.</p>

			{% for country in country_list %}

				<section class="country-list my-2 lg:my-4">

					<h2 class="text-2xl my-4 border-b-2 border-black">{{ country.grouper }} ({{ country.list|length }})</h2>
					
					{% for obj in country.list %}
						<article class="provider-listing lg:w-3/4 my-6 lg:mr-0 lg:ml-auto py-6 border-b-2 border-neutral-200 last:border-0">
							<div class="prose mx-auto lg:ml-0 lg:mr-auto">

								<h4 class="inline-block mb-0 font-bold text-xl" id="{{ obj.id }}">{{ obj.name }}</h4>

								{% if obj.website %}						
									<a target="_blank" rel="noopener noreferrer" href="https://{{ obj.website|urlencode }}">	
										<img class="utility-icon external-link-icon" width="16px" height="16px" src="{% static 'img/icon-external-link.svg' %}" alt="Visit {{ obj.name }}'s website"/>
									</a>
								{% endif %}
								
								<p class="text-neutral-700 mt-2 mb-3">
									{% if obj.description %}
										{{ obj.description }}
									{% else %}
										<small class"text-sm">If we had a description it would go here. So we need some graceful fallback copy to replace this.</small>
									{% endif %}
								</p>

								<ul class="mb-4 pl-0">
									{% if obj.services.names %}
										{% for service in obj.services.all %}<li class="service-label inline-block">{{ service.name }}</li>{% endfor %}
										{% comment %}
										Every host in our directory used to at least offer shared hosting.
										Below is a placeholder to see how it would look with live data.
									{% else %}
										<li class="service-label inline-block">Compute: Shared Hosting for Websites</li>
										{% endcomment %}
									{% endif %}
								</ul>

								{% if obj.public_supporting_evidence %}
									<details class="mb-4">
										<summary>
											<span class="">Published supporting evidence</span>
										</summary>

										<ul class="mt-3">
											{% for evidence in obj.public_supporting_evidence %}
												<li class="m-3">
													<a class="my-2" target="_blank" rel="noopener noreferrer" href="{{ evidence.link }}">{{ evidence.title }}</a>

													{% if evidence.description %}
														<div class="evidence-description text-sm">
															{{ evidence.description|linebreaks }}
														</div>
													{% endif %}
												</li>
											{% endfor %}
										</ul>
									</details>
								{% endif %}
							</div>
						</article>
					{% endfor %}
				</section>

			{% endfor %}
    </section>

<p>Are you missing a green hosting provider in this list? Get verified yourself or ask your provider to get verified with us.</p>

{% endblock %}

